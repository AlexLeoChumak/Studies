<!DOCTYPE html>
<html lang="ru">
    <head>
        <meta charset=utf-8>
        <title>Practical task #18 (clock-svg)</title>
        <meta name="viewport" content="width=device-width, initial-scale=1">
        <style>
            .miniCircleNumber{
                font-family: Arial, Helvetica, sans-serif;
            }
        </style>
    </head>
    <body>
        <svg id='clock'></svg>
    </body>  
        <script>
            'use strict';

            const svg = document.querySelector('#clock');
            const nameSpaceXML = 'http://www.w3.org/2000/svg';
            const svgWidth = 1000;
            const svgHeight = svgWidth;
            svg.style.xmlns = nameSpaceXML;
            svg.style.width = svgWidth;
            svg.style.height = svgHeight;
            const time = new Date();
            const circleCenterCX = svgWidth / 2;
            const circleCenterCY = svgWidth / 2;
            const radiusCircle = svgWidth / 2;
            const colorCircle = 'yellow';
            const secondArrowHeight = svgWidth / 2.2;
            const secondArrowWidth = svgWidth / 100;
            const minuteArrowHeight = svgWidth / 3;
            const minuteArrowWidth = svgWidth / 70;
            const hourArrowHeight = svgWidth / 5;
            const hourArrowWidth = svgWidth / 35;
            const radiusMiniCircle = svgWidth / 2.5;
            const spaceBetweenNumbers = 30;
            const hourNumber = 12;
            const centerArrow = svgWidth / 2 + 'px';
            const fontSizeNumbers = svgWidth / 15;
            let i = 1;
            let currentAngle = 0;
            let secondArrow;
            let minuteArrow;
            let hourArrow;

            let secondsDeg = 6 * time.getSeconds() - 6;
            let minutesDeg = 6 * (time.getMinutes() + (1 / 60) * time.getSeconds());
            let hoursDeg = 30 * (time.getHours() + (1 / 60) * time.getMinutes());

            const circleBigClock = document.createElementNS(nameSpaceXML, 'circle');

            function setAttributes(variable, attr) {
                for(let key in attr) {
                    variable.setAttribute(key, attr[key]);
                }  
            }

            setAttributes(circleBigClock, {
                'cx': circleCenterCX, 
                'cy': circleCenterCY, 
                'r': radiusCircle, 
                'fill': colorCircle
            });
            svg.append(circleBigClock);

            const svgCenterX = svg.getBoundingClientRect().left + svg.getBoundingClientRect().width / 2;
            const svgCenterY = svg.getBoundingClientRect().top + svg.getBoundingClientRect().height / 2;

            while (i <= hourNumber) {
                const miniCircle = document.createElementNS(nameSpaceXML, 'circle');
                const miniCircleNumber = document.createElementNS(nameSpaceXML, 'text');
                const miniCircleRadius = svgWidth / 15;
                const miniCircleColor = 'green';

                currentAngle += spaceBetweenNumbers;
                const angle = currentAngle * Math.PI / 180;
                const miniCircleCenterCX = Math.round(svgCenterX + radiusMiniCircle * Math.sin(angle) - svg.getBoundingClientRect().left);
                const miniCircleCenterCY = Math.round(svgCenterY - radiusMiniCircle * Math.cos(angle) - svg.getBoundingClientRect().top);
                
                setAttributes(miniCircle, {
                    'cx': miniCircleCenterCX, 
                    'cy': miniCircleCenterCY, 
                    'r': miniCircleRadius, 
                    'fill': miniCircleColor,
                });

                miniCircleNumber.innerHTML = i;

                setAttributes(miniCircleNumber, {
                    'class': 'miniCircleNumber', 
                    'x': miniCircleCenterCX, 
                    'y': miniCircleCenterCY, 
                    'text-anchor': 'middle', 
                    'dominant-baseline': 'central',
                    'font-size': fontSizeNumbers
                });

                svg.append(miniCircle);
                svg.append(miniCircleNumber);
                i++;
            }

            let digitalClock = document.createElementNS(nameSpaceXML, 'rect');
            svg.append(digitalClock);
            const digitalClockRadius = svgWidth / 6;

            setAttributes(digitalClock, {
                'x': (svgCenterX - digitalClock.getBoundingClientRect().width / 2) - svg.getBoundingClientRect().left, 
                'y': (svgCenterY - digitalClockRadius) - svg.getBoundingClientRect().left,
                'fill': 'none'
            });

            let digitalClockFace = document.createElementNS(nameSpaceXML, 'text');

            setAttributes(digitalClockFace, {
                'x': (svgCenterX - digitalClock.getBoundingClientRect().width / 2) - svg.getBoundingClientRect().left, 
                'y': (svgCenterY - digitalClockRadius) - svg.getBoundingClientRect().top,
                'text-anchor': 'middle',
                'dominant-baseline': 'central',
                'class': 'miniCircleNumber',
                'font-size': fontSizeNumbers
            });
            svg.append(digitalClockFace);

            hourArrow = document.createElementNS(nameSpaceXML, 'line');

            setAttributes(hourArrow, {
                'class': 'hourArrow', 
                'x1': svgCenterX - svg.getBoundingClientRect().left,
                'y1': svgCenterY - hourArrowHeight - svg.getBoundingClientRect().top,
                'x2': svgCenterX - svg.getBoundingClientRect().left,
                'y2': svgCenterY,
                'stroke': 'black',
                'stroke-width': hourArrowWidth,
                'stroke-linecap': 'round',
                'transform-origin': centerArrow
            });
            svg.append(hourArrow);

            minuteArrow = document.createElementNS(nameSpaceXML, 'line');

            setAttributes(minuteArrow, {
                'class': 'minuteArrow', 
                'x1': svgCenterX - svg.getBoundingClientRect().left,
                'y1': svgCenterY - minuteArrowHeight - svg.getBoundingClientRect().top,
                'x2': svgCenterX - svg.getBoundingClientRect().left,
                'y2': svgCenterY,
                'stroke': 'black',
                'stroke-width': minuteArrowWidth,
                'stroke-linecap': 'round',
                'transform-origin': centerArrow
            });
            svg.append(minuteArrow);

            secondArrow = document.createElementNS(nameSpaceXML, 'line');

            setAttributes(secondArrow, {
                'class': 'secondArrow', 
                'x1': svgCenterX - svg.getBoundingClientRect().left,
                'y1': svgCenterY - secondArrowHeight - svg.getBoundingClientRect().top,
                'x2': svgCenterX - svg.getBoundingClientRect().left,
                'y2': svgCenterY,
                'stroke': 'black',
                'stroke-width': secondArrowWidth,
                'stroke-linecap': 'round',
                'transform-origin': centerArrow
            });
            svg.append(secondArrow);

            function setPositionArrows() {
                secondsDeg += 6;
                secondArrow.style.transform = 'rotate(' + secondsDeg + 'deg)';

                minutesDeg += 6 * (1/60);
                minuteArrow.style.transform = 'rotate(' + minutesDeg + 'deg)';

                hoursDeg += 6 * (1/360);
                hourArrow.style.transform = 'rotate(' + hoursDeg + 'deg)';

                const time = new Date();
                digitalClockFace.innerHTML = time.toLocaleTimeString();
            }

        setPositionArrows();
        setTimeout(function run() {
            setPositionArrows();
            setTimeout(run, 1000)
        });
        </script>
    </body> 
</html>